<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Document</title>
<link rel="stylesheet" href="/css/slick.css" />
<link rel="stylesheet" href="/css/slick-theme.css" />

<link rel="stylesheet" href="/css/test1.css">


</head>
<body>
	<header>
		<div class="header">

			<div class="logo">

				<img src="/images/logo noback.png" alt="logo" class="logo">


			</div>

			<div class="header_bar">

				<div class="search">
				<div id="suggestions" ></div>
					<input type="text" id="search" placeholder="Search..."
						class="search" action="">
					

					<button class="search_button" name="search"></button>
					<img src="/images/magnifying-glass-dollar-solid.svg" alt="Search">
				</div>

				<div class="nav_bar">

					<div class="head">
						<a href="home">Home</a> <a href="goodspage">一般商城</a> <a
							href="usedgoodspage">二手商城</a> <a href="#contact">品牌</a>
					</div>

				</div>

			</div>

			<div class="icon_area">
				<div class="icons">

					<a class="icons" href="member"><img src="/images/會員中心.png"
						alt="User"></a> <a class="icons" href="/mem/login"><img
						src="/images/log-in.png" alt="Login"></a> <a class="icons"
						href="#"><img src="/images/聊天室(FAQ 客服).png" alt="Chat"></a>
					<a class="icons" href="/shoppingcartlist/listAllShoppingCartList"><img src="/images/購物車.png" alt="Cart"></a>

				</div>

				<div class="coupon_area">

					<a class="coupon" th:href="@{/front-end/coupon/list}"><img src="/images/優惠卷領取頁面圖示.png"
						alt="coupon"></a>

				</div>

			</div>



		</div>
		<div id="carousel-container"></div>
	</header>



	<div class="slider">
		<img src="/Gp_Photos/1001.jpg" alt=""> <img
			src="/Gp_Photos/1002.jpg" alt=""> <img
			src="/Gp_Photos/1003.jpg" alt=""> <img
			src="/Gp_Photos/1004.jpg" alt=""> <img
			src="/Gp_Photos/1005.jpg" alt="">

	</div>
	
	<div class="goods_body">

		

		<div class="bestsell_goods">
		
			<div class="goods" id="1">
				 <img src="/images/Designer.jpeg" alt="goods">
			</div>
			<div class="goods" id="2">
				 <img src="/images/Designer.jpeg" alt="goods">
			</div>
			<div class="goods" id="3">
			<img src="/images/Designer.jpeg" alt="goods">
			</div>
			<div class="goods" id="4">
						<img src="/images/Designer.jpeg" alt="goods">
			</div>
			<div class="goods" id="5">
						<img src="/images/Designer.jpeg" alt="goods">

			</div>
			<div class="goods" id="6">
				<img src="/images/Star 6.png" alt="star"> <img
					src="/images/Designer.jpeg" alt="goods">
			</div>
			<div class="goods" id="7">
							<img src="/images/Designer.jpeg" alt="goods">

			</div>
			<div class="goods" id="8">
							<img src="/images/Designer.jpeg" alt="goods">

			</div>
			<div class="goods" id="9">
							<img src="/images/Designer.jpeg" alt="goods">

			</div>
			<div class="goods" id="10">
							<img src="/images/Designer.jpeg" alt="goods">

			</div>
		</div>
	</div>

	<footer>
		<div>© 2024 DO BUY. All Rights Reserved.</div>
	</footer>





	<script type="text/javascript" src="/js/jquery3.7.1.js"></script>
	<script src="/js/slick.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.8/axios.min.js"
		integrity="sha512-v8+bPcpk4Sj7CKB11+gK/FnsbgQ15jTwZamnBf/xDmiQDcgOIYufBo6Acu1y30vrk8gg5su4x0CG3zfPaq5Fcg=="
		crossorigin="anonymous"></script>


	<script>
        $('.slider').slick({
            centerMode:true,
           
            slidesToShow: 1,
            slidesToScroll: 1,
            infinite:true,
            autoplay:true,
            autoplaySpeed: 5000,  
            dots: false,
            arrows: false,
        });
       
    
     
        // 防抖動函數
        function debounce(func, delay) {
            let timeoutId;
            return function (...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => {
                    func(...args);
                }, delay);
            };
        }

        // 獲取 DOM 元素
        const searchBar = document.getElementById('search');
        const suggestionsBox = document.getElementById('suggestions');

        // 防抖動處理的搜尋函數
        async function handleSearch() {
            const query = searchBar.value.trim();
            if (query.length < 1) {
                suggestionsBox.innerHTML = '';  // 清空建議
                suggestionsBox.style.display = 'none';  // 隱藏建議框
                return;
            }

            try {
                const response = await axios.get(`/search`, { params: { query } });
                let products = response.data;

                // 檢查產品是否為空
                if (!Array.isArray(products) || products.length === 0) {
                    suggestionsBox.innerHTML = '<div>沒有找到相關商品</div>';
                    suggestionsBox.style.display = 'block';
                    return;
                }

                // 根據商品名稱中搜尋字詞的匹配度來排序
                products = products.sort((a, b) => {
                    const queryLower = query.toLowerCase();
                    const aIndex = a.goodsName.toLowerCase().indexOf(queryLower);
                    const bIndex = b.goodsName.toLowerCase().indexOf(queryLower);
                    if (aIndex === 0 && bIndex !== 0) return -1;
                    if (bIndex === 0 && aIndex !== 0) return 1;
                    return aIndex - bIndex;
                });

                suggestionsBox.innerHTML = '';
                suggestionsBox.style.display = products.length > 0 ? 'block' : 'none';

                // 顯示建議項
                products.forEach(product => {
                    const div = document.createElement('div');
                    div.classList.add('suggestion');
                    div.textContent = product.goodsName;
                    div.addEventListener('click', () => {
                        searchBar.value = product.goodsName;
                        suggestionsBox.innerHTML = '';
                        suggestionsBox.style.display = 'none';
                        const targetUrl = `/counter/getOneGoods?goodsNo=${encodeURIComponent(product.goodsNo)}`;
                        window.location.href = targetUrl;
                    });
                    suggestionsBox.appendChild(div);
                });
            } catch (error) {
                console.error('獲取建議時發生錯誤:', error);
                suggestionsBox.innerHTML = '<div>發生錯誤，請稍後重試。</div>';
                suggestionsBox.style.display = 'block';
            }
        }

        // 將搜尋函數應用防抖動，並設置延遲（例如：300 毫秒）
        const debouncedSearch = debounce(handleSearch, 300);
        searchBar.addEventListener('input', debouncedSearch);

        // 監聽鍵盤按下事件（用來處理 Enter 鍵）
        searchBar.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault();  // 防止 Enter 觸發表單提交

                const query = searchBar.value.trim(); // 獲取輸入框內容
                if (query.length < 1) return; // 如果沒有輸入，則不處理

                // 觸發搜尋並跳轉到 goodspage，並將搜尋字串作為 URL 參數
                window.location.href = `/goodspage?search=${encodeURIComponent(query)}`;
            }
        });

        
    </script>



</body>
</html>


